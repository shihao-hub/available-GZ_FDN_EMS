import pandas as pd
from io import StringIO
import matplotlib.pyplot as plt

# 原始CSV数据（此处仅展示部分，实际需粘贴全部数据）
csv_data = """时间,Line0,Line1,Line2,Line3,Line4,Line5,Line6,Line7,Line8,Line9,Line10,Line11,Line12,Line13,Line14,Line15,Line16,Line17,Line18,Line19,Line20,Line21,Line22,Line23,Line24,Line25,Line26,Line27,Line28,Line29,Line30,Line31,Line32,Line33,Line34,Line35,Line36
2023-01-01 00:00:00,0.00014671463723615208,0.00013124680988577111,0.00011020598928872533,0.00010764750935224346,0.00010624736030405795,8.53291490851176e-05,8.111433313827156e-05,3.006239819315956e-05,1.6856602899185012e-05,1.5212912762354736e-05,1.4628548791390923e-05,1.3539649238974941e-05,1.201947535137339e-05,9.520040595303754e-06,7.371550043250989e-06,5.1071110275080665e-06,3.0875191978230443e-06,1.0010877895973067e-05,8.345060169550065e-06,4.974481648376634e-06,1.04738176519207e-06,1.9217333832877556e-05,1.66041254544096e-05,4.940757869273556e-06,2.1121276048722106e-05,1.966344957474027e-05,1.9268976481750428e-05,1.8789052291495165e-05,1.8614648620161482e-05,9.08325297552373e-06,6.6024606714293805e-06,4.15850893776587e-08,0.0,0.0,0.0,0.0,0.0
2023-01-01 01:00:00,0.00015332347571265316,0.00013756044068671876,0.00011561414978796046,0.00011300704539469841,0.00011161130208976542,8.876337941629674e-05,8.504268516997543e-05,3.489941396764578e-05,1.6856233762471253e-05,1.525272730485625e-05,1.462742969409767e-05,1.3497825064946974e-05,1.2073451227402718e-05,9.599435002256468e-06,7.443399527681167e-06,5.105679997108696e-06,3.1471909347486933e-06,1.001168274546577e-05,8.332200734637443e-06,4.88460302002828e-06,1.015860216478446e-06,2.002548501275877e-05,1.7415381172348698e-05,5.074213144560534e-06,2.3152923626405326e-05,2.1425511474712856e-05,2.0836166992988284e-05,2.0362652871790107e-05,2.018144774428561e-05,9.87332061310258e-06,6.47580544765888e-06,5.213874225802621e-08,0.0,0.0,0.0,0.0,0.0
..."""  # 粘贴所有数据行

# 解析CSV
df = pd.read_csv(StringIO(csv_data), parse_dates=['时间'])

# 设置时间索引
df.set_index('时间', inplace=True)

# 基础分析
print("数据前5行：")
print(df.head())

print("\n数据统计摘要：")
print(df.describe())

# 可视化
df.filter(like='Line').plot(figsize=(15, 8), alpha=0.7)
plt.title('各线路随时间变化趋势')
plt.ylabel('数值')
plt.grid(True)
plt.show()

# 计算每小时总和
df['Hourly_Total'] = df.filter(like='Line').sum(axis=1)
print("\n每小时总和：")
print(df['Hourly_Total'].head())